title: MOVEit exploitation CVE-2023-34362
id: a5d2c153-c3b9-4e95-a611-d54b3c12c16f
status: experimental
description: |
    MOVEitTransfer is affected by a critical vulnerability CVE-2023-34362. Exploited hosts show evidence of dynamically compliling a DLL, which then executes a script (file path for this temp file is C:\Windows\TEMP\[random]\[random].cmdline) to create a webshell that so far has always been named 'human2.aspx'.
    The filepaths 'c:\moveittransfer\wwwroot' and 'C:\Windows\Microsoft\.NET\Framework64\v4\.0\.30319\Temporary ASP\.NET Files\root' should be investigated for recently modified files.
    Evidence of exploitation can also be found on the webserver logs for the MOVEit Transfer application.
references:
  - https://www.huntress.com/blog/moveit-transfer-critical-vulnerability-rapid-response
  - https://www.trustedsec.com/blog/critical-vulnerability-in-progress-moveit-transfer-technical-analysis-and-recommendations/
  - https://nvd.nist.gov/vuln/detail/CVE-2023-34362
  - https://community.progress.com/s/article/MOVEit-Transfer-Critical-Vulnerability-31May2023
author: Huntress DE&TH Team
date: 2023/06/02
tags:
    - attack.execution
    - attack.t1059
    - attack.t1203
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        ParentImage|endswith: '\w3wp.exe'
        ParentCommandLine|contains: 'moveitdmz pool'
        Image|endswith: '\csc.exe'
        CommandLine|contains: 'Windows\temp\'
    condition: selection
falsepositives:
    - Unknown
level: high
